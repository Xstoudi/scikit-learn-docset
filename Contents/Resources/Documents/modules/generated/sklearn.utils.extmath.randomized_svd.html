
<!DOCTYPE html>

<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
<meta charset="utf-8"/>
<meta content="Docutils 0.19: https://docutils.sourceforge.io/" name="generator">
<meta content="sklearn.utils.extmath.randomized_svd" property="og:title"/>
<meta content="website" property="og:type"/>
<meta content="https://scikit-learn/stable/modules/generated/sklearn.utils.extmath.randomized_svd.html" property="og:url"/>
<meta content="scikit-learn" property="og:site_name"/>
<meta content="https://scikit-learn.org/stable/_static/scikit-learn-logo-small.png" property="og:image"/>
<meta content="scikit-learn" property="og:image:alt"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>sklearn.utils.extmath.randomized_svd — scikit-learn 1.2.2 documentation</title>
<link href="http://scikit-learn.org/stable/modules/generated/sklearn.utils.extmath.randomized_svd.html" rel="canonical"/>
<link href="../../_static/favicon.ico" rel="shortcut icon"/>
<link href="../../_static/css/vendor/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="../../_static/pygments.css" rel="stylesheet" type="text/css"/>
<link href="../../_static/css/theme.css" rel="stylesheet" type="text/css"/>
<link href="../../_static/plot_directive.css" rel="stylesheet" type="text/css"/>
<link href="../../_static/sg_gallery.css" rel="stylesheet" type="text/css"/>
<link href="../../_static/sg_gallery-binder.css" rel="stylesheet" type="text/css"/>
<link href="../../_static/sg_gallery-dataframe.css" rel="stylesheet" type="text/css"/>
<link href="../../_static/sg_gallery-rendered-html.css" rel="stylesheet" type="text/css"/>
<link href="../../_static/css/theme.css" rel="stylesheet" type="text/css"/>
<script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
<script src="../../_static/js/vendor/jquery-3.6.3.slim.min.js"></script>
</meta></head>
<body>
<nav class="sk-docs-navbar navbar navbar-expand-md navbar-light bg-light py-0" id="navbar">
<div class="container-fluid sk-docs-container px-0">
<a class="navbar-brand py-0" href="../../index.html">
<img alt="logo" class="sk-brand-img" src="../../_static/scikit-learn-logo-small.png"/>
</a>
<button aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#navbarSupportedContent" data-toggle="collapse" id="sk-navbar-toggler" type="button">
<span class="navbar-toggler-icon"></span>
</button>
<div class="sk-navbar-collapse collapse navbar-collapse" id="navbarSupportedContent">
<ul class="navbar-nav mr-auto">
<li class="nav-item">
<a class="sk-nav-link nav-link" href="../../install.html">Install</a>
</li>
<li class="nav-item">
<a class="sk-nav-link nav-link" href="../../user_guide.html">User Guide</a>
</li>
<li class="nav-item">
<a class="sk-nav-link nav-link" href="../classes.html">API</a>
</li>
<li class="nav-item">
<a class="sk-nav-link nav-link" href="../../auto_examples/index.html">Examples</a>
</li>
<li class="nav-item">
<a class="sk-nav-link nav-link" href="https://blog.scikit-learn.org/" rel="noopener noreferrer" target="_blank">Community</a>
</li>
<li class="nav-item">
<a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../../getting_started.html">Getting Started</a>
</li>
<li class="nav-item">
<a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../../tutorial/index.html">Tutorial</a>
</li>
<li class="nav-item">
<a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../../whats_new/v1.2.html">What's new</a>
</li>
<li class="nav-item">
<a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../../glossary.html">Glossary</a>
</li>
<li class="nav-item">
<a class="sk-nav-link nav-link nav-more-item-mobile-items" href="https://scikit-learn.org/dev/developers/index.html" rel="noopener noreferrer" target="_blank">Development</a>
</li>
<li class="nav-item">
<a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../../faq.html">FAQ</a>
</li>
<li class="nav-item">
<a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../../support.html">Support</a>
</li>
<li class="nav-item">
<a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../../related_projects.html">Related packages</a>
</li>
<li class="nav-item">
<a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../../roadmap.html">Roadmap</a>
</li>
<li class="nav-item">
<a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../../governance.html">Governance</a>
</li>
<li class="nav-item">
<a class="sk-nav-link nav-link nav-more-item-mobile-items" href="../../about.html">About us</a>
</li>
<li class="nav-item">
<a class="sk-nav-link nav-link nav-more-item-mobile-items" href="https://github.com/scikit-learn/scikit-learn">GitHub</a>
</li>
<li class="nav-item">
<a class="sk-nav-link nav-link nav-more-item-mobile-items" href="https://scikit-learn.org/dev/versions.html">Other Versions and Download</a>
</li>
<li class="nav-item dropdown nav-more-item-dropdown">
<a aria-expanded="false" aria-haspopup="true" class="sk-nav-link nav-link dropdown-toggle" data-toggle="dropdown" href="#" id="navbarDropdown" role="button">More</a>
<div aria-labelledby="navbarDropdown" class="dropdown-menu">
<a class="sk-nav-dropdown-item dropdown-item" href="../../getting_started.html">Getting Started</a>
<a class="sk-nav-dropdown-item dropdown-item" href="../../tutorial/index.html">Tutorial</a>
<a class="sk-nav-dropdown-item dropdown-item" href="../../whats_new/v1.2.html">What's new</a>
<a class="sk-nav-dropdown-item dropdown-item" href="../../glossary.html">Glossary</a>
<a class="sk-nav-dropdown-item dropdown-item" href="https://scikit-learn.org/dev/developers/index.html" rel="noopener noreferrer" target="_blank">Development</a>
<a class="sk-nav-dropdown-item dropdown-item" href="../../faq.html">FAQ</a>
<a class="sk-nav-dropdown-item dropdown-item" href="../../support.html">Support</a>
<a class="sk-nav-dropdown-item dropdown-item" href="../../related_projects.html">Related packages</a>
<a class="sk-nav-dropdown-item dropdown-item" href="../../roadmap.html">Roadmap</a>
<a class="sk-nav-dropdown-item dropdown-item" href="../../governance.html">Governance</a>
<a class="sk-nav-dropdown-item dropdown-item" href="../../about.html">About us</a>
<a class="sk-nav-dropdown-item dropdown-item" href="https://github.com/scikit-learn/scikit-learn">GitHub</a>
<a class="sk-nav-dropdown-item dropdown-item" href="https://scikit-learn.org/dev/versions.html">Other Versions and Download</a>
</div>
</li>
</ul>
<div id="searchbox" role="search">
<div class="searchformwrapper">
<form action="../../search.html" class="search" method="get">
<input aria-labelledby="searchlabel" class="sk-search-text-input" name="q" type="text"/>
<input class="sk-search-text-btn" type="submit" value="Go"/>
</form>
</div>
</div>
</div>
</div>
</nav>
<div class="d-flex" id="sk-doc-wrapper">
<input id="sk-toggle-checkbox" name="sk-toggle-checkbox" type="checkbox"/>
<label class="sk-btn-toggle-toc btn sk-btn-primary" for="sk-toggle-checkbox" id="sk-sidemenu-toggle">Toggle Menu</label>
<div class="border-right" id="sk-sidebar-wrapper">
<div class="sk-sidebar-toc-wrapper">
<div aria-label="rellinks" class="btn-group w-100 mb-2" role="group">
<a class="btn sk-btn-rellink py-1" href="sklearn.utils.extmath.randomized_range_finder.html" role="button" sk-rellink-tooltip="sklearn.utils.extmath.randomized_range_finder">Prev</a><a class="btn sk-btn-rellink py-1" href="../classes.html" role="button" sk-rellink-tooltip="API Reference">Up</a>
<a class="btn sk-btn-rellink py-1" href="sklearn.utils.extmath.fast_logdet.html" role="button" sk-rellink-tooltip="sklearn.utils.extmath.fast_logdet">Next</a>
</div>
<div class="alert alert-danger p-1 mb-2" role="alert">
<p class="text-center mb-0">
<strong>scikit-learn 1.2.2</strong><br/>
<a href="http://scikit-learn.org/dev/versions.html">Other versions</a>
</p>
</div>
<div class="alert alert-warning p-1 mb-2" role="alert">
<p class="text-center mb-0">
            Please <a class="font-weight-bold" href="../../about.html#citing-scikit-learn"><string>cite us</string></a> if you use the software.
          </p>
</div>
<div class="sk-sidebar-toc">
<ul>
<li><a class="reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sklearn.utils.extmath</span></code>.randomized_svd</a><ul>
<li><a class="reference internal" href="#sklearn.utils.extmath.randomized_svd"><code class="docutils literal notranslate"><span class="pre">randomized_svd</span></code></a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div id="sk-page-content-wrapper">
<div class="sk-page-content container-fluid body px-md-3" role="main">
<section id="sklearn-utils-extmath-randomized-svd">
<h1><code class="xref py py-mod docutils literal notranslate"><span class="pre">sklearn.utils.extmath</span></code>.randomized_svd<a class="headerlink" href="#sklearn-utils-extmath-randomized-svd" title="Permalink to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="sklearn.utils.extmath.randomized_svd">
<span class="sig-prename descclassname"><span class="pre">sklearn.utils.extmath.</span></span><span class="sig-name descname"><span class="pre">randomized_svd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_oversamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">power_iteration_normalizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transpose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip_sign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svd_lapack_driver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gesdd'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/scikit-learn/scikit-learn/blob/364c77e04/sklearn/utils/extmath.py#L287"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="dashAnchor" name="//apple_ref/cpp/Function/sklearn.utils.extmath.randomized_svd"></a><a class="headerlink" href="#sklearn.utils.extmath.randomized_svd" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a truncated randomized SVD.</p>
<p>This method solves the fixed-rank approximation problem described in <a class="reference internal" href="#rf38c2b656ebc-1" id="id1">[1]</a>
(problem (1.5), p5).</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>M</strong><span class="classifier">{ndarray, sparse matrix}</span></dt><dd><p>Matrix to decompose.</p>
</dd>
<dt><strong>n_components</strong><span class="classifier">int</span></dt><dd><p>Number of singular values and vectors to extract.</p>
</dd>
<dt><strong>n_oversamples</strong><span class="classifier">int, default=10</span></dt><dd><p>Additional number of random vectors to sample the range of M so as
to ensure proper conditioning. The total number of random vectors
used to find the range of M is n_components + n_oversamples. Smaller
number can improve speed but can negatively impact the quality of
approximation of singular vectors and singular values. Users might wish
to increase this parameter up to <code class="docutils literal notranslate"><span class="pre">2*k</span> <span class="pre">-</span> <span class="pre">n_components</span></code> where k is the
effective rank, for large matrices, noisy problems, matrices with
slowly decaying spectrums, or to increase precision accuracy. See <a class="reference internal" href="#rf38c2b656ebc-1" id="id2">[1]</a>
(pages 5, 23 and 26).</p>
</dd>
<dt><strong>n_iter</strong><span class="classifier">int or ‘auto’, default=’auto’</span></dt><dd><p>Number of power iterations. It can be used to deal with very noisy
problems. When ‘auto’, it is set to 4, unless <code class="docutils literal notranslate"><span class="pre">n_components</span></code> is small
(&lt; .1 * min(X.shape)) in which case <code class="docutils literal notranslate"><span class="pre">n_iter</span></code> is set to 7.
This improves precision with few components. Note that in general
users should rather increase <code class="docutils literal notranslate"><span class="pre">n_oversamples</span></code> before increasing <code class="docutils literal notranslate"><span class="pre">n_iter</span></code>
as the principle of the randomized method is to avoid usage of these
more costly power iterations steps. When <code class="docutils literal notranslate"><span class="pre">n_components</span></code> is equal
or greater to the effective matrix rank and the spectrum does not
present a slow decay, <code class="docutils literal notranslate"><span class="pre">n_iter=0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code> should even work fine in theory
(see <a class="reference internal" href="#rf38c2b656ebc-1" id="id3">[1]</a> page 9).</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.18.</span></p>
</div>
</dd>
<dt><strong>power_iteration_normalizer</strong><span class="classifier">{‘auto’, ‘QR’, ‘LU’, ‘none’}, default=’auto’</span></dt><dd><p>Whether the power iterations are normalized with step-by-step
QR factorization (the slowest but most accurate), ‘none’
(the fastest but numerically unstable when <code class="docutils literal notranslate"><span class="pre">n_iter</span></code> is large, e.g.
typically 5 or larger), or ‘LU’ factorization (numerically stable
but can lose slightly in accuracy). The ‘auto’ mode applies no
normalization if <code class="docutils literal notranslate"><span class="pre">n_iter</span></code> &lt;= 2 and switches to LU otherwise.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.18.</span></p>
</div>
</dd>
<dt><strong>transpose</strong><span class="classifier">bool or ‘auto’, default=’auto’</span></dt><dd><p>Whether the algorithm should be applied to M.T instead of M. The
result should approximately be the same. The ‘auto’ mode will
trigger the transposition if M.shape[1] &gt; M.shape[0] since this
implementation of randomized SVD tend to be a little faster in that
case.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.18.</span></p>
</div>
</dd>
<dt><strong>flip_sign</strong><span class="classifier">bool, default=True</span></dt><dd><p>The output of a singular value decomposition is only unique up to a
permutation of the signs of the singular vectors. If <code class="docutils literal notranslate"><span class="pre">flip_sign</span></code> is
set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, the sign ambiguity is resolved by making the largest
loadings for each component in the left singular vectors positive.</p>
</dd>
<dt><strong>random_state</strong><span class="classifier">int, RandomState instance or None, default=’warn’</span></dt><dd><p>The seed of the pseudo random number generator to use when
shuffling the data, i.e. getting the random vectors to initialize
the algorithm. Pass an int for reproducible results across multiple
function calls. See <a class="reference internal" href="../../glossary.html#term-random_state"><span class="xref std std-term">Glossary</span></a>.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.2: </span>The default value changed from 0 to None.</p>
</div>
</dd>
<dt><strong>svd_lapack_driver</strong><span class="classifier">{“gesdd”, “gesvd”}, default=”gesdd”</span></dt><dd><p>Whether to use the more efficient divide-and-conquer approach
(<code class="docutils literal notranslate"><span class="pre">"gesdd"</span></code>) or more general rectangular approach (<code class="docutils literal notranslate"><span class="pre">"gesvd"</span></code>) to compute
the SVD of the matrix B, which is the projection of M into a low
dimensional subspace, as described in <a class="reference internal" href="#rf38c2b656ebc-1" id="id4">[1]</a>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.2.</span></p>
</div>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>u</strong><span class="classifier">ndarray of shape (n_samples, n_components)</span></dt><dd><p>Unitary matrix having left singular vectors with signs flipped as columns.</p>
</dd>
<dt><strong>s</strong><span class="classifier">ndarray of shape (n_components,)</span></dt><dd><p>The singular values, sorted in non-increasing order.</p>
</dd>
<dt><strong>vh</strong><span class="classifier">ndarray of shape (n_components, n_features)</span></dt><dd><p>Unitary matrix having right singular vectors with signs flipped as rows.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This algorithm finds a (usually very good) approximate truncated
singular value decomposition using randomization to speed up the
computations. It is particularly fast on large matrices on which
you wish to extract only a small number of components. In order to
obtain further speed up, <code class="docutils literal notranslate"><span class="pre">n_iter</span></code> can be set &lt;=2 (at the cost of
loss of precision). To increase the precision it is recommended to
increase <code class="docutils literal notranslate"><span class="pre">n_oversamples</span></code>, up to <code class="docutils literal notranslate"><span class="pre">2*k-n_components</span></code> where k is the
effective rank. Usually, <code class="docutils literal notranslate"><span class="pre">n_components</span></code> is chosen to be greater than k
so increasing <code class="docutils literal notranslate"><span class="pre">n_oversamples</span></code> up to <code class="docutils literal notranslate"><span class="pre">n_components</span></code> should be enough.</p>
<p class="rubric">References</p>
<div class="citation-list" role="list">
<a class="dashAnchor" name="//apple_ref/cpp/Section/rf38c2b656ebc-1"></a><div class="citation" id="rf38c2b656ebc-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a href="#id1" role="doc-backlink">1</a>,<a href="#id2" role="doc-backlink">2</a>,<a href="#id3" role="doc-backlink">3</a>,<a href="#id4" role="doc-backlink">4</a>)</span>
<p><a class="reference external" href="https://arxiv.org/abs/0909.4061">“Finding structure with randomness:
Stochastic algorithms for constructing approximate matrix decompositions”</a>
Halko, et al. (2009)</p>
</div>
<a class="dashAnchor" name="//apple_ref/cpp/Section/rf38c2b656ebc-2"></a><div class="citation" id="rf38c2b656ebc-2" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>A randomized algorithm for the decomposition of matrices
Per-Gunnar Martinsson, Vladimir Rokhlin and Mark Tygert</p>
</div>
<a class="dashAnchor" name="//apple_ref/cpp/Section/rf38c2b656ebc-3"></a><div class="citation" id="rf38c2b656ebc-3" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></span>
<p>An implementation of a randomized algorithm for principal component
analysis A. Szlam et al. 2014</p>
</div>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.utils.extmath</span> <span class="kn">import</span> <span class="n">randomized_svd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">U</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">Vh</span> <span class="o">=</span> <span class="n">randomized_svd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">U</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">Vh</span><span class="o">.</span><span class="n">shape</span>
<span class="go">((3, 2), (2,), (2, 4))</span>
</pre></div>
</div>
</dd></dl>
<div class="clearer"></div></section>
</div>
<div class="container">
<footer class="sk-content-footer">
            © 2007 - 2023, scikit-learn developers (BSD License).
          <a href="../../_sources/modules/generated/sklearn.utils.extmath.randomized_svd.rst.txt" rel="nofollow">Show this page source</a>
</footer>
</div>
</div>
</div>
<script src="../../_static/js/vendor/bootstrap.min.js"></script>
<script>
    window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
    ga('create', 'UA-22606712-2', 'auto');
    ga('set', 'anonymizeIp', true);
    ga('send', 'pageview');
</script>
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script data-domain="scikit-learn.org" defer="" src="https://views.scientific-python.org/js/script.js">
</script>
<script>
$(document).ready(function() {
    /* Add a [>>>] button on the top-right corner of code samples to hide
     * the >>> and ... prompts and the output and thus make the code
     * copyable. */
    var div = $('.highlight-python .highlight,' +
                '.highlight-python3 .highlight,' +
                '.highlight-pycon .highlight,' +
		'.highlight-default .highlight')
    var pre = div.find('pre');

    // get the styles from the current theme
    pre.parent().parent().css('position', 'relative');
    var hide_text = 'Hide prompts and outputs';
    var show_text = 'Show prompts and outputs';

    // create and add the button to all the code blocks that contain >>>
    div.each(function(index) {
        var jthis = $(this);
        if (jthis.find('.gp').length > 0) {
            var button = $('<span class="copybutton">&gt;&gt;&gt;</span>');
            button.attr('title', hide_text);
            button.data('hidden', 'false');
            jthis.prepend(button);
        }
        // tracebacks (.gt) contain bare text elements that need to be
        // wrapped in a span to work with .nextUntil() (see later)
        jthis.find('pre:has(.gt)').contents().filter(function() {
            return ((this.nodeType == 3) && (this.data.trim().length > 0));
        }).wrap('<span>');
    });

    // define the behavior of the button when it's clicked
    $('.copybutton').click(function(e){
        e.preventDefault();
        var button = $(this);
        if (button.data('hidden') === 'false') {
            // hide the code output
            button.parent().find('.go, .gp, .gt').hide();
            button.next('pre').find('.gt').nextUntil('.gp, .go').css('visibility', 'hidden');
            button.css('text-decoration', 'line-through');
            button.attr('title', show_text);
            button.data('hidden', 'true');
        } else {
            // show the code output
            button.parent().find('.go, .gp, .gt').show();
            button.next('pre').find('.gt').nextUntil('.gp, .go').css('visibility', 'visible');
            button.css('text-decoration', 'none');
            button.attr('title', hide_text);
            button.data('hidden', 'false');
        }
    });

	/*** Add permalink buttons next to glossary terms ***/
	$('dl.glossary > dt[id]').append(function() {
		return ('<a class="headerlink" href="#' +
			    this.getAttribute('id') +
			    '" title="Permalink to this term">¶</a>');
	});
});

</script>
<script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
</body>
</html>